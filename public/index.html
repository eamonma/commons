<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Learning Commons</title>
  {{>meta}}
</head>

<body>
  <header>
    <div class="title">
      <a href="#"><img class="crest" src="img/crest.png" alt="Handsworth Crest"></a>
      <h1><a href="#">Handsworth Learning&nbsp;Commons</a></h1>
    </div>
    <nav>
      <ul>
        <a class="links" href="#">
          <li>Home</li>
        </a>
        <a class="links" href="books">
          <li>Books</li>
        </a>
        <a class="links" href="resources">
          <li>Resources</li>
        </a>
        <a class="links" href="faq">
          <li>FAQ</li>
        </a>
        <a class="links" href="teachers">
          <li>Teachers</li>
        </a>
        <a class="links" href="tutor">
          <li>Peer tutoring</li>
        </a>
      </ul>
    </nav>
  </header>

  <div class="notifications">
    <p class="blocks">Rotation for <span id="date"></span> is <span id="blockRotation"></span>. <em class="customize"><a id="customize" href="#"></a></em></p>
  </div>
  <!--  carousel and books -->
  <div class="carry columns">
    <div class="carousel content">
      <div class="carouselImage1"></div>
      <div class="carouselImage2"></div>
      <div class="carouselImage3"></div>
      <div class="carouselImage4"></div>
      <div class="carouselImage5"></div>
      <div class="carouselImage6"></div>
      <div class="carouselImage7"></div>
      <!-- <div class="carouselImage8"></div>
      <div class="carouselImage9"></div>
      <div class="carouselImage10"></div>
      <div class="carouselImage11"></div>
      <div class="carouselImage12"></div> -->
      <div class="carouselImage13"></div>
      <div class="carouselImage14"></div>
    </div>
    <div class="ftbook content">
      <h2>New books</h2><a class="int" id="viewMore" href="books"><em>More books</em></a>
      <div class="newBook book1">
        <img src="img/kp.jpg" alt="Cover of Kitchen Princess">
        <h3>Kitchen Princess <span class="bookAuthor">by Natsumi Ando and Miyuki Kobayashi</span></h3>
        <p class="quote">I love the storyline of this manga, it's a mix of drama, romance, and a tiny bit of action. My favorite character in the series is Daichi Kitazawa because he is so funny, and gets really jealous, almost like a child. I hope other people read this
          manga because it is really interesting. I could stay up all night reading Kitchen Princess. The art is amazing, and I hope one day I will be able to draw characters as pretty as Natsumi Ando! I hope other people enjoy this manga just like I
          do!
        </p>
        <p class="quoteAuthor">Abigail Hathway<br>Handsworth Student, Grade 8</p>
      </div>

      <div class="newBook moreB book2">
        <img src="img/ach.jpg" alt="Cover of Anything Could Happen">
        <h3>Anything Could Happen <span class="bookAuthor">by Will Walton</span></h3>
        <p class="quote">I first saw this book by Will Walton in a recommended feed. Ms. McHugh ordered it for Library and when it came in I got straight to reading! Anything Could Happen is a universal love story that will surprize you. It is enthralling and well worth
          the read. It is a wholesome LGBTQ story that will make you happy you picked it up!</p>
        <p class="quoteAuthor">Aakib Janmohamed<br>Handsworth Student, Grade 9</p>
      </div>
    </div>
  </div>

  <!-- catalogue and resources -->
  <div class="larry columns">
    <div class="catalogue content">
      <h2>Catalogue</h2>
      <div class="districtCatalogue">
        <a class="ext" href="https://sd44.follettdestiny.ca">Handsworth catalogue</a>
      </div>
    </div>
    <div class="resources content">
      <h2>Resources</h2>
      <p><em>Obtain login information from staff</em></p>
      <div class="ebsco">
        <h3>Ebsco</h3>
        <a href="http://search.ebscohost.com" class="ext">Ebsco homepage</a>
      </div>
      <h3>World Books</h3>
      <div class="wbstudent">
        <h4>Student</h4>
        <a class="ext" href="http://www.worldbookonline.com">World Book Online Homepage</a>
      </div>
      <div class="wbadvanced">
        <h4>Advanced</h4>
        <a class="ext" href="http://www.worldbookonline.com">World Book Online Homepage</a>
      </div>
    </div>
  </div>

  <!-- staff -->
  <div class="rarry columns">
    <div class="staff content">
      <h2>Staff</h2>
      <div class="staffs mchugh">
        <img class="staffPhoto" src="img/staff1.jpg" alt="The First Staff">
        <p>Ms. McHugh<br>Teacher Librarian<br><em>Social Studies</em></p>
      </div>
      <div class="staffs audia">
        <img class="staffPhoto" src="img/@sstaff2.jpg" alt="The Second Staff">
        <p>Mr. Audia<br>Teacher Librarian<br><em>Social Studies</em></p>
      </div>
    </div>
  </div>

  <!-- small screen menu icon -->
  <div class="mobileMenu">
    <div>
      <button class="b hamburger hamburger--spin icon" type="button">
        <span class="b hamburger-box">
          <span class="b hamburger-inner"></span>
        </span>
      </button>
    </div>
  </div>

  <footer>
    <p><a class="ext" href="https://handsworth.ca">Handsworth</a></p>
    <p>&copy; 2019 <em>By Handsworth students <a href="https://eamon.me">Eamon Ma</a></em>, <em><a href="https://www.linkedin.com/in/owen-holman/">Owen Holman</a></em>, and <em><a href="https://www.jacob-schwartz.com/">Jacob Schwartz</a></em></p>
  </footer>
  <div class="personalizeCourses">
    <h3>Personalize courses</h3>
    <ul>
      <li><input id="block1" class="block" type="text" name="block" placeholder="Block 1" value=""></li>
      <li><input id="block2" class="block" type="text" name="block" placeholder="Block 2" value=""></li>
      <li><input id="block3" class="block" type="text" name="block" placeholder="Block 3" value=""></li>
      <li><input id="block4" class="block" type="text" name="block" placeholder="Block 4" value=""></li>
      <li><input id="block5" class="block" type="text" name="block" placeholder="Block 5" value=""></li>
      <li><input id="block6" class="block" type="text" name="block" placeholder="Block 6" value=""></li>
      <li><input id="block7" class="block" type="text" name="block" placeholder="Block 7" value=""></li>
      <li><input id="block8" class="block" type="text" name="block" placeholder="Block 8" value=""></li>
      <a id="confirmCourses" href="#">Confirm</a>
      <a id="deleteCourses" href="#">Delete all</a>
      <a id="cancelChange" href="#">Cancel</a>
    </ul>

  </div>
</body>
<link rel="stylesheet" href="burger.css">
<script type="text/javascript">
  var weekdays = [
    "Sunday",
    "Monday",
    "Tuesday",
    "Wednesday",
    "Thursday",
    "Friday",
    "Saturday"
  ];

  var months = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December"
  ];

  var schedule = {
    utility: {
      // returns the days since the unix epoch
      daysSince: function(ms) {
        return Math.floor(ms / 8.64e7);
      },
      // returns the day no, being 1 or 2, depending on the day
      dayNo: function(days) {
        return (days % 2 === 1) ? (1) : (2);
      },
      // return the weekday, 0 being Sunday
      weekday: function(days) {
        return (days + 4) % 7;
      },
      // returns the week no, being 1 or 2, depending on the week
      weekNo: function(days) {
        return (((days + 4) % 14) < 7) ? (1) : (2);
      },
      gmtToLocal: function(time) {
        return time - (new Date().getTimezoneOffset()) * 60 * 1000;
      },
      localToGmt: function(time) {
        return time + (new Date().getTimezoneOffset()) * 60 * 1000;
      },
      queue: function(array) {
        var last = array.shift();
        array.push(last);
        return array;
      },
      unqueue: function(array) {
        var first = array.pop();
        array.unshift(first);
        return array;
      },
      getFourthBlock: function(day, courses) {
        return (day === 1) ? (courses[3]) : (courses[7]);
      },
      setCourses: function(courses) {
        return localStorage.setItem("courses", JSON.stringify(courses));
      },
      getCourses: function() {
        return JSON.parse(localStorage.getItem("courses"));
      },
      promptCourses: function(length, list) {
        //list of items with input fields
        length = length ? length : 8;
        var result = [];
        for (var i = 0; i < 8; i++) {
          var course = list[i].value;
          // var course = prompt("What is your block " + (i + 1) + " ?");
          result.push({
            name: course
          });
        }
        return result;
      },
      deleteCourses: function() {
        localStorage.removeItem("courses");
      },
      coursesToArray: function(list) {
        var arr = [];
        list.forEach(function(course) {
          arr.push(course.name);
        });
        return arr;
      }
    },
    generate: function(weekNo, courses) {
      var weeks = [];
      var weekOne = [];
      var weekTwo = [];
      var one = courses.slice(0, 4);
      var oneMorning = one.slice(0, 3);
      var two = courses.slice(4);
      var twoMorning = two.slice(0, 3);
      var _ = this.utility;

      var returnedOne = [];
      returnedOne = oneMorning.slice(0);

      var returnedTwo = [];
      returnedTwo = twoMorning.slice(0);

      for (var i = 0; i < 10; i++) {
        if (i % 2 === 0) {
          // if day 1
          if (i === 0) {
            // if monday of 1
            weeks.push(oneMorning);
            continue;
          }
          var tempArr = returnedOne;
          tempArr = _.queue(returnedOne);
          weeks.push(tempArr.slice(0));
        } else {
          // if day 2
          if (i === 1) {
            // if tuesday of 1
            weeks.push(twoMorning);
            continue;
          }
          var tempArr = returnedTwo;
          tempArr = _.queue(returnedTwo);
          weeks.push(tempArr.slice(0));
        }
      }

      weekOne = weeks.slice(0, 5);
      weekTwo = weeks.slice(5);
      // returns weekOne for week 1
      return (weekNo === 1) ? (weekOne) : (weekTwo);
    }
  };
  var _ = schedule.utility;
  try {
    var alreadySetCourses = _.getCourses();
  } catch (e) {
    var alreadySetCourses = null;
  }
  console.log(alreadySetCourses);
  var courses = (alreadySetCourses) ? (_.coursesToArray(alreadySetCourses)) : [1, 2, 3, 4, 5, 6, 7, 8];
  var date = new Date();
  var ms = date.getTime();
  ms = _.gmtToLocal(ms) + 2.88e7;
  var dayOfMonth = date.getDate();
  var days = _.daysSince(ms);
  var dayNo = _.dayNo(days);
  var weekNo = _.weekNo(days);
  var weekday = _.weekday(days);
  var hours = date.getHours();
  var tomorrowOrNot = hours > 15 ? "(tomorrow)" : "";
  var weekdayEnglish = weekdays[weekday];
  var month = date.getMonth();
  var monthEnglish = months[month];
  var year = date.getYear() + 1900;
  var dateEnglish = weekdayEnglish + " " + monthEnglish + " " + ((!tomorrowOrNot) ? (dayOfMonth) : (dayOfMonth + 1)) + ", " + year + " " + tomorrowOrNot;
  if (weekday == 0 || weekday == 6) {
    dateEnglish = "";
  }
  var weekSchedule = schedule.generate(weekNo, courses);
  try {
    var rotationArray = weekSchedule[weekday - 1];
  } catch (e) {
    var rotationArray = [];
  }
  var rotation = "";
  try {
    for (var i = 0; i < rotationArray.length; i++) {
      rotation += rotationArray[i] + "-";
    }
  } catch (e) {}
  rotation += _.getFourthBlock(dayNo, courses);
  var notifDate = document.getElementById("date");
  var notifBlock = document.getElementById("blockRotation");
  notifDate.innerText = dateEnglish;
  blockRotation.innerText = rotation;

  if (weekday == 0 || weekday == 6) {
    document.getElementsByClassName("blocks")[0].innerText = "No school.";
  }

  var customizeButton = document.getElementById("customize");
  var confirmCourses = document.getElementById("confirmCourses");
  var personalizeCourses = document.getElementsByClassName("personalizeCourses")[0];
  var deleteCourses = document.getElementById("deleteCourses");
  var cancelChange = document.getElementById("cancelChange");
  try {
    customizeButton.innerText = ((alreadySetCourses) ? ("Change courses") : ("Personalize"));
    customizeButton.onclick = function() {
      personalizeCourses.classList.add("show");
    }

  } catch (e) {}

  confirmCourses.onclick = function() {
    _.deleteCourses();
    var userCourses = document.getElementsByClassName("block");
    var courses = _.promptCourses(8, userCourses);
    _.setCourses(courses);
    console.log(userCourses);
    personalizeCourses.classList.remove("show");
    console.log(courses);
    window.location.reload();
  }

  deleteCourses.onclick = function() {
    _.deleteCourses();
    window.location.reload();
  }

  cancelChange.onclick = function() {
    personalizeCourses.classList.remove("show");
  }

  var carouselObject = document.getElementsByClassName("carousel")[0];
  var carousel = new Siema({
    selector: carouselObject,
    duration: 500,
    easing: 'ease-in',
    perPage: 1,
    startIndex: 0,
    draggable: true,
    multipleDrag: true,
    threshold: 20,
    loop: true,
    rtl: false,
    onInit: () => {},
    onChange: () => {},
  });
  var nextSlide = setInterval(() => carousel.next(), 3000);
  carouselObject.onmousedown = function() {
    clearInterval(nextSlide);
  }
  carouselObject.onmouseup = function() {
    nextSlide = setInterval(() => carousel.next(), 3000);
  }
</script>

</html>
